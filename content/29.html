<!DOCTYPE html>
<html>
<head>
<title>thinkphp5å®‰è£…redisæ‰©å±•ï¼Œä»¥åŠMacå®‰è£…redisæœåŠ¡ - ç‹ç»´çš„åšå®¢</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="thinkphp,phpredis,redis"/>
<meta name="description" content="thinkphpå®‰è£…redisæ‰©å±•ï¼Œå®‰è£…redisæœåŠ¡" />
<link rel="shortcut icon" href="/favicon.ico" />
<link href="/bootstrap-5.3.0/css/bootstrap.min.css" rel="stylesheet">
<link href="/highlight/styles/a11y-dark.min.css" rel="stylesheet">
<script src="/bootstrap-5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="/common/jquery.min.js"></script>
<script src="/common/search.js"></script>
<script src="/highlight/highlight.min.js"></script>
<script >hljs.initHighlightingOnLoad();</script>
<style type="text/css">
    body {
        margin-top: 70px;
    }
    h1 {
        font-size: 18px;
    }
    h3 {
        font-size: 16px;
    }
    p {
        font-size: 14px;
    }
    img {
        max-width: 100%;
    }
    pre {
        padding: 10px;
    }
</style>
</head>
<body>
    <nav class="navbar navbar-expand-md bg-dark navbar-dark fixed-top">
	<div class="container">
		<a class="navbar-brand" href="/index.html">ç‹ç»´çš„åšå®¢</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav me-auto">
								<li class="nav-item"><a class="nav-link " href="/index.html">é¦–é¡µ</a></li>
								<li class="nav-item"><a class="nav-link active" href="/categories/php.html">PHP</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/vue.html">Vue</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/unicloud.html">uniCloud</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/python.html">Python</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/notes.html">éšæ‰‹ç¬”è®°</a></li>
							</ul>
            <div class="d-flex" role="search">
                <input class="form-control me-2" type="search" placeholder="æœç´¢æ–‡ç« " aria-label="search" id="input">
                <button class="btn btn-outline-light text-nowrap" type="button" id="search">æœç´¢</button>
            </div>
		</div>
	</div>
</nav>
    <div class="container content">
        <div class="mt-3">
            <h1>thinkphp5å®‰è£…redisæ‰©å±•ï¼Œä»¥åŠMacå®‰è£…redisæœåŠ¡</h1>
            <span class="date"><small>2022-06-24</small></span>
            <div class="mt-4">
                <p>Redisï¼ˆRemote Dictionary Serverï¼‰æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„key-valueå­˜å‚¨ç³»ç»Ÿï¼Œç”±äºæ•°æ®å­˜å‚¨åœ¨è®¡ç®—æœºçš„å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½éå¸¸é«˜ï¼Œå¸¸ç”¨äºå­˜å‚¨ä¸€äº›é¢‘ç¹è¯»å–çš„å†…å®¹ï¼Œä»è€Œé¿å…é€ æˆæ•°æ®åº“I/Oç“¶é¢ˆã€‚</p><p>thinkphpæ”¯æŒredisï¼Œæœ¬æ–‡å°±è®°å½•ä¸€ä¸‹æ•´ä¸ªå®‰è£…è¿‡ç¨‹ã€‚</p><p><strong>ä¸€ã€å®‰è£…phpçš„redisæ‰©å±•</strong></p><p>1ã€å…ˆç¡®å®šæœ¬æœºæˆ–æœåŠ¡å™¨çš„PHPç‰ˆæœ¬ï¼Œä»¥åŠå®‰è£…ç›®å½•ï¼Œæœ¬æœºä¸ºphp7.4ï¼Œå®‰è£…ç›®å½•ä¸º/usr/local/opt/php@7.4/ï¼Œåœ¨ç»ˆç«¯ä¸­è¿›å…¥åˆ°è¯¥ç›®å½•<br/></p><pre class="javascript">cd&nbsp;/usr/local/opt/php@7.4/bin/</pre><p>2ã€ä¸‹è½½phpredis<br/></p><pre class="javascript">git&nbsp;clone&nbsp;https://github.com/nicolasff/phpredis.git</pre><p>3ã€è¿›å…¥ä¸‹è½½çš„æ–‡ä»¶å¤¹</p><pre class="javascript">cd&nbsp;phpredis</pre><p>å½“å‰è·¯å¾„åº”è¯¥æ˜¯/usr/local/opt/php@7.4/bin/phpredisï¼Œä¸€å®šè¦ä¿è¯è·¯å¾„æ­£ç¡®</p><p>4ã€ä½¿ç”¨phpizeå‘½ä»¤ç¼–è¯‘ç”Ÿæˆconfigureé…ç½®æ–‡ä»¶</p><pre class="javascript">/usr/local/opt/php@7.4/bin/phpize&nbsp;--with-php-config=/usr/local/opt/php@7.4/bin/php-config</pre><p>5ã€é…ç½®phpredis</p><pre class="javascript">./configure&nbsp;--with-php-config=/usr/local/opt/php@7.4/bin/php-config</pre><p>6ã€ç¼–è¯‘å®‰è£…</p><pre class="javascript">make&nbsp;&amp;&amp;&nbsp;make&nbsp;install</pre><p>7ã€å®‰è£…å®Œåï¼Œä¿®æ”¹php.iniï¼Œå¼€å¯redisæ‰©å±•ï¼Œå¦‚ä¸ç¡®å®šæ–‡ä»¶ä½ç½®ï¼Œå¯ä½¿ç”¨php --iniæ¥å®šä½</p><pre class="javascript">...
extension=xxx
extension=redis.so
...</pre><p>8ã€é…ç½®åï¼Œé‡å¯php-fpmæœåŠ¡ï¼Œæˆ–è€…é‡å¯apacheå³å¯ã€‚</p><pre class="javascript">brew&nbsp;services&nbsp;start/restart&nbsp;php@7.4</pre><p><strong>äºŒã€å®‰è£…redisæœåŠ¡</strong></p><p>æœ¬æœºæˆ–æœåŠ¡å™¨å®‰è£…redisæœ‰å¤šç§æ–¹å¼ï¼Œå¯ä»¥ç”¨ä¸‹è½½å®‰è£…çš„æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ç”¨å‘½ä»¤è¡Œå®‰è£…ã€‚æœ¬æœºæ˜¯Macï¼Œå¯ä»¥ç”¨HomeBrewçš„æ–¹å¼å®‰è£…</p><p><strong>å‘½ä»¤è¡Œå®‰è£…æ–¹å¼ï¼ˆæ¨èï¼‰</strong></p><p>1ã€æŸ¥æ‰¾redisç‰ˆæœ¬</p><pre class="javascript">brew&nbsp;search&nbsp;redis</pre><p>å‘½ä»¤æ‰§è¡Œåä¼šåˆ—å‡ºæ‰€æœ‰redisç‰ˆæœ¬ï¼Œæ ‡æœ‰@ç¬¦å·çš„åé¢æ˜¯ç‰ˆæœ¬å·ï¼Œæœªæ ‡æ˜çš„æ˜¯æœ€æ–°ç‰ˆæœ¬<br/></p><p>2ã€ç›´æ¥å®‰è£…æœ€æ–°ç‰ˆæœ¬</p><pre class="javascript">brew&nbsp;install&nbsp;redis</pre><p>ç­‰å¾…å‡ åˆ†é’Ÿå®‰è£…å®Œåï¼Œæç¤ºä¿¡æ¯ç±»ä¼¼ä¸‹é¢</p><pre>==&gt;&nbsp;Downloading&nbsp;https://mirrors.ustc.edu.cn/homebrew-bottles/redis-6.2.4&nbsp;
##################################################################&nbsp;100%
==&gt;&nbsp;Pouring&nbsp;redis-6.2.4.mojave.bottle.tar.gz
==&gt;&nbsp;Caveats
To&nbsp;have&nbsp;launchd&nbsp;start&nbsp;redis&nbsp;now&nbsp;and&nbsp;restart&nbsp;at&nbsp;login:
&nbsp;&nbsp;brew&nbsp;services&nbsp;start&nbsp;redis
Or,&nbsp;if&nbsp;you&nbsp;don&#39;t&nbsp;want/need&nbsp;a&nbsp;background&nbsp;service&nbsp;you&nbsp;can&nbsp;just&nbsp;run:
&nbsp;&nbsp;redis-server&nbsp;/usr/local/etc/rredis.conf
==&gt;&nbsp;Summary
ğŸº&nbsp;/usr/local/Cellar/redis/6.2.4:&nbsp;13&nbsp;files,&nbsp;4.1MB</pre><p>æ˜¾ç¤ºè¿™äº›ä¿¡æ¯ï¼Œå°±è¡¨ç¤ºredisæœåŠ¡å®‰è£…æˆåŠŸäº†ã€‚</p><p><strong>ä¸‹è½½å®‰è£…æ–¹å¼</strong></p><p>å®˜æ–¹ç½‘ç«™åœ°å€ï¼š<a href="https://redis.io" target="_blank">https://redis.io</a>ï¼Œä¸‹è½½é“¾æ¥ï¼š<a href="https://download.redis.io/redis-stable.tar.gz" target="_blank">https://download.redis.io/redis-stable.tar.gz</a><strong><br/></strong></p><p>ä¸‹è½½åè§£å‹<br/></p><pre class="javascript">tar&nbsp;-zvxf&nbsp;redis-stable.tar.gz</pre><p>è§£å‹åï¼Œè¿›å…¥åˆ°è§£å‹æ–‡ä»¶å¤¹</p><pre class="javascript">cd&nbsp;redis-stable
make&nbsp;&amp;&amp;&nbsp;make&nbsp;install</pre><p>ç­‰å¾…å®‰è£…å®Œæˆå³å¯ï¼Œéœ€è¦æ³¨æ„æ‰‹åŠ¨ä¸‹è½½å®‰è£…çš„æ–¹å¼ï¼Œè¦æ‰‹åŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…è¿›å…¥åˆ°rediså®‰è£…ç›®å½•æ‰èƒ½æ‰§è¡Œredis-serverç›¸å…³å‘½ä»¤<strong><br/></strong></p><p><strong>ä¸‰ã€å¯åŠ¨redisæœåŠ¡</strong></p><p>æœ‰ä¸¤ç§æ–¹å¼å¯åŠ¨redis</p><p>1ã€é€šè¿‡brew servicesæ¥å¯åŠ¨</p><pre class="javascript">brew&nbsp;services&nbsp;start&nbsp;redis</pre><p>2ã€é€šè¿‡redisé»˜è®¤å‘½ä»¤redis-serveræ¥å¯åŠ¨</p><pre class="javascript">#&nbsp;æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œä»¥å®ˆæŠ¤æ¨¡å¼å¯åŠ¨ï¼Œåœ¨åå°è¿è¡Œï¼Œå…³é—­çª—å£ä¸ä¼šåœæ­¢
redis-server&nbsp;/usr/local/etc/redis.conf
#&nbsp;é»˜è®¤å‚æ•°å¯åŠ¨ï¼Œä»¥è°ƒè¯•æ¨¡å¼å¯åŠ¨ï¼Œå…³é—­çª—å£å³åœæ­¢
redis-server</pre><p>æŒ‰ctrl+cå³å¯åœæ­¢redisæœåŠ¡å™¨ï¼ˆè·ŸGateWayworkerçš„ç”¨æ³•ç±»ä¼¼ï¼‰ã€‚</p><p>3ã€è¿æ¥redisæœåŠ¡</p><pre class="javascript">#&nbsp;è¿œç¨‹æœåŠ¡è¿æ¥
redis-cli&nbsp;-h&nbsp;IP&nbsp;-p&nbsp;6379
#&nbsp;æœ¬æœºæœåŠ¡è¿æ¥
redis-cli
#&nbsp;å…³é—­redisæœåŠ¡
redis-cli&nbsp;shutdown</pre><p><strong>å››ã€PHPè¿æ¥redisä¾‹å­</strong></p><p>phpè¿æ¥rediséƒ½å·®ä¸å¤šï¼Œç›´æ¥å¤åˆ¶ç½‘ä¸Šçš„</p><pre class="php">//&nbsp;Index/index.php
public&nbsp;function&nbsp;redis()
{
&nbsp;&nbsp;&nbsp;&nbsp;$redis&nbsp;=&nbsp;new&nbsp;\Redis();
&nbsp;&nbsp;&nbsp;&nbsp;$redis-&gt;connect(&#39;127.0.0.1&#39;,6379);
&nbsp;&nbsp;&nbsp;&nbsp;$redis-&gt;set(&#39;test&#39;,&#39;Redisæ‰©å±•æ·»åŠ æˆåŠŸ&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;$redis-&gt;get(&#39;test&#39;);
}</pre><p>æµè§ˆå™¨ä¸­è®¿é—®è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœè¾“å‡ºâ€œRedisæ‰©å±•æ·»åŠ æˆåŠŸâ€ï¼Œåˆ™è¡¨ç¤ºæ‰€æœ‰å·¥ä½œå·²ç»å®Œæˆï¼</p><p><strong>äº”ã€thinkphpä½¿ç”¨redisä½œä¸ºç¼“å­˜</strong></p><p>å‰é¢è®²è¿‡ï¼Œthinkphpæ˜¯æ”¯æŒredisçš„ï¼Œä¿®æ”¹config.phpï¼ŒæŠŠcacheä»Fileä¿®æ”¹ä¸ºredisï¼Œå³å¯åˆ‡æ¢ä¸ºredisç¼“å­˜</p><pre class="javascript">//&nbsp;application/config.php
&#39;cache&#39;&nbsp;=&gt;&nbsp;[
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;é©±åŠ¨æ–¹å¼
&nbsp;&nbsp;&nbsp;&nbsp;&#39;type&#39;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;&#39;Redis&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ç¼“å­˜ä¿å­˜ç›®å½•
&nbsp;&nbsp;&nbsp;&nbsp;&#39;path&#39;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;CACHE_PATH,
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ç¼“å­˜å‰ç¼€
&nbsp;&nbsp;&nbsp;&nbsp;&#39;prefix&#39;&nbsp;=&gt;&nbsp;&#39;&#39;,
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;ç¼“å­˜æœ‰æ•ˆæœŸ&nbsp;0è¡¨ç¤ºæ°¸ä¹…ç¼“å­˜
&nbsp;&nbsp;&nbsp;&nbsp;&#39;expire&#39;&nbsp;=&gt;&nbsp;0,
],</pre><p>å³å¯äº«å—rediså¸¦æ¥çš„é«˜é€Ÿç¼“å­˜æœåŠ¡å•¦ï½</p><p><strong>å…­ã€æ€»ç»“</strong></p><p>1ã€phpçš„redisæ‰©å±•å’Œç”µè„‘éœ€è¦å®‰è£…çš„redisæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„ä¸œè¥¿ï¼Œå³phpè·Ÿredisè¿™ä¸¤è€…æ²¡æœ‰ä»»ä½•å…³ç³»ï¼›ä¾‹å¦‚thinkphpæ”¯æŒmysqlæ•°æ®åº“ï¼Œä½†ç”µè„‘ä»ç„¶éœ€è¦å®‰è£…mysqlï¼›</p><p>2ã€thinkphpæœ‰è‡ªå¸¦çš„redisç»„ä»¶ï¼Œæ–‡ä»¶åœ¨/thinkphp/cache/driver/Redis.phpï¼Œä½†å®ƒä»ç„¶ä¾èµ–phpçš„redisæ‰©å±•ï¼›</p><p>3ã€ä¹Ÿå°±æ˜¯è¯´ï¼Œphpçš„redisæ‰©å±•ã€thinkphpçš„redisç»„ä»¶å’Œæœ¬æœºéœ€è¦å®‰è£…çš„redisæœåŠ¡ï¼Œè¿™ä¸‰è€…æ˜¯ç›¸äº’ç‹¬ç«‹çš„ä¸”å„å¸å…¶èŒï¼Œç¼ºä¸€ä¸å¯ï¼›</p><p>4ã€redisæœåŠ¡çš„ç”¨æ³•è·Ÿgatewayworkerå·®ä¸å¤šï¼Œéƒ½æ˜¯ä»¥cliæ–¹å¼è¿è¡Œï¼Œå¹¶ä¸ä¾èµ–äºapache/nginxï¼Œä¹Ÿå°±æ˜¯è¯´redisæœåŠ¡å¯ä»¥éƒ¨ç½²åˆ°ä»»æ„æœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡è¿œç¨‹è¿æ¥ä½¿ç”¨ï¼Œéå¸¸é€‚åˆåˆ†å¸ƒå¼éƒ¨ç½²ã€‚</p>            </div>
        </div>
    </div>
    <footer class="footer mt-3 bg-dark">
    <div class="container pt-3 pb-3 text-light text-center">Copyright &copy;ç‹ç»´ 2023</div>
</footer>
</body>
</html>