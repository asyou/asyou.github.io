<!DOCTYPE html>
<html>
<head>
<title>fastadmin后台动态渲染latex为数学公式 - 王维的博客</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="fastadmin,latex,数学公式"/>
<meta name="description" content="fastadmin后台动态渲染latex为数学公式" />
<link rel="shortcut icon" href="/favicon.ico" />
<link href="/bootstrap-5.1.3/css/bootstrap.min.css" rel="stylesheet">
<script src="/bootstrap-5.1.3/js/bootstrap.bundle.min.js"></script>
<link href="/highlight/styles/a11y-dark.min.css" rel="stylesheet">
<script src="/highlight/highlight.min.js"></script>
<script >hljs.initHighlightingOnLoad();</script>
<style type="text/css">
    body {
        margin-top: 70px;
    }
    h1 {
        font-size: 18px;
    }
    h3 {
        font-size: 16px;
    }
    p {
        font-size: 14px;
    }
    img {
        max-width: 100%;
    }
    pre {
        padding: 10px;
    }
</style>
</head>
<body>
    <nav class="navbar navbar-expand-md bg-dark navbar-dark fixed-top">
	<div class="container">
		<a class="navbar-brand" href="/index.html">王维的博客</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarNav">
			<ul class="navbar-nav">
								<li class="nav-item"><a class="nav-link " href="/index.html">首页</a></li>
								<li class="nav-item"><a class="nav-link active" href="/categories/php.html">PHP</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/vue.html">Vue</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/unicloud.html">uniCloud</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/python.html">Python</a></li>
								<li class="nav-item"><a class="nav-link " href="/categories/notes.html">随手笔记</a></li>
							</ul>
		</div>
	</div>
</nav>
    <div class="container">
        <div class="content mt-3">
            <h1>fastadmin后台动态渲染latex为数学公式</h1>
            <span class="date"><small>2022-08-11</small></span>
            <div class="mt-4">
                <p>最近都在研究latex公式渲染的问题，包括PC网页、vue小程序、uniapp混合App中的渲染。<br/></p><p>本文记录的是如何在Fastadmin后台动态渲染latex为公式的问题。</p><p>先说前提，Fastadmin后台的数据列表，不是传统的展示方式，它是JS通过Ajax加载的方式来展示的，换句话说就是在普通网页中能用的MathJax公式渲染方式在这个后台并不起作用，需要另想办法。</p><p>仔细研究了下，Fa提供了单个字段特殊渲染的方式，比如渲染图片可以用formatter: Table.api.formatter.image，这个也支持使用function自定义渲染。</p><p>既然支持自定义function渲染，就有办法了，直接在function里面return一个MathJax线上latex转图片不就行了？</p><pre class="javascript">//&nbsp;test.js
formatter:function&nbsp;(value)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;&lt;img&nbsp;src=&quot;http://latex.codecogs.com/gif.latex?&#39;+value+&#39;&quot;&gt;&#39;
}</pre><p>结果发现不太行，如果字段全是latex公式不包含其他字符的话确实可以，但实际上数学题目往往是这样的：已知二次函数$y=-x^{2}+2x+4$则下列关于这个函数图象和性质的说法,正确的是()，既有公式也有文字，这种方式转换会出现错误。</p><p>解决思路：</p><p>1、因为公式都是统一用$符号包裹的，所以可以利用这个符号对字符串进行split切割成数组；</p><p>2、再循环判断每个子字符串中是否包含中文（公式中是不会出现中文的）；</p><p>3、如果包含中文则不处理，否则进行公式转换；</p><p>4、最后按顺序组装各个子字符串。</p><pre class="javascript">//&nbsp;test.js
formatter:function&nbsp;(value)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;content&nbsp;=&nbsp;&#39;&#39;;
&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;arr&nbsp;=&nbsp;value.split(&#39;$&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;$.each(arr,&nbsp;function(i,o)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(escape(o).indexOf(&quot;%u&quot;)&nbsp;&lt;&nbsp;0)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;+=&nbsp;&#39;&lt;img&nbsp;src=&quot;http://latex.codecogs.com/gif.latex?&#39;+o+&#39;&quot;&gt;&#39;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;+=&nbsp;o
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;})
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;content;
}</pre><p>运行结果：</p><p><img src="/uploads/20220811/e2e4d97d13cbbdbe815903347cf050f5.png"/></p><p>经过实际测试，完全达到了预期效果！</p><p><br/></p>            </div>
        </div>
    </div>
    <footer class="footer mt-3 bg-dark">
    <div class="container pt-3 pb-3 text-light text-center">Copyright &copy;王维 2022 254555778@qq.com</div>
</footer>
</body>
</html>